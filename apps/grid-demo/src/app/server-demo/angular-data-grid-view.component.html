<div class="grid-wrapper" [class.loading]="isLoading">
  <lib-data-grid
    #dataGrid
    *ngIf="gridOptions"
    [options]="gridOptions"
      (sortChange)="onSortChange($event)"
    (filterChange)="onFilterChange($event)"
    (pageChange)="onPageChange($event)"
    (dataStateChange)="onDataStateChange($event)"
    (groupToggle)="onGroupToggle($event)"
      (loadMore)="onLoadMore($event)"
      (exportRequest)="onExportRequest($event)">
  </lib-data-grid>
  <div *ngIf="!gridOptions" class="loading-message">
    <span class="loading-spinner" aria-hidden="true"></span>
    <span class="loading-text">Loading data...</span>
  </div>
  
  <!-- Loading Indicator - Shows in data area only -->
  <!-- The loading indicator is added via CSS pseudo-elements on grid-body -->
</div>

<!-- Custom Templates -->
<ng-template #statusTemplate let-row let-value="value">
  <span [class]="value ? 'badge badge-success' : 'badge badge-danger'">
    {{ value ? 'Active' : 'Inactive' }}
  </span>
</ng-template>

<ng-template #ratingTemplate let-row let-value="value">
  <div class="rating-display">
    <span class="stars">{{ getStars(value) }}</span>
    <span class="rating-value">({{ value.toFixed(1) }})</span>
  </div>
</ng-template>

<ng-template #payloadTemplate let-row let-value="value">
  <button 
    class="payload-icon-btn" 
    (click)="openPayloadPopup(value); $event.stopPropagation()"
    title="View payload"
    *ngIf="value">
    <span class="payload-icon">ðŸ“„</span>
  </button>
  <span *ngIf="!value" class="payload-empty">-</span>
</ng-template>

<app-payload-popup 
  [payload]="currentPayload"
  [visible]="showPayloadPopup"
  (close)="closePayloadPopup()">
</app-payload-popup>
